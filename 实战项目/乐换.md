# 一、前端

## 1.前端页面构建分页栏显示

```js
//定义搜索对象的结构，传给后端，充当搜索条件，除了spec是json，其他都是字符串，当需要新增搜索条件时，只需要在后面添加对应的key即可
    //pageNo：页码；pageSize：总页数
    $scope.searchMap = {
        'keywords': '', 'category': '', 'brand': '', 'spec': {}, 'price': '',
        'pageNo': 1, 'pageSize': 40, 'sort': '', 'sortField': ''};//搜索条件封装对象

//中间省略一堆代码

//构建分页栏
    //构建分页标签(totalPages为总页数),如果搜索的商品太多，会导致页面太多不美观，于是设定为最多显示五页：1,2,3,4,5，
    // 然后显示下一页，以当前页为中心的5个页码，要判断当前页要大于等于3，或者小于最大页码-2
    // 则显示结果为：1 2 3 4 5或：1 2 ... 5 6 7
    buildPageLabel = function () {
        //构建分页栏，即分页码1，2，3，4，5...
        $scope.pageLabel = [];  //新增分页栏数组
        // 8 9 10 11 12,8为开始页码，12位截止页码
        var firstPage = 1;  //开始页码
        var lastPage = $scope.resultMap.totalPages;//截止页码
        $scope.firstDot = true;     //前面有省略号小点
        $scope.lastDot = true;      //后边有省略号小点
        // 总页数分为两大类：多于5页，少于等于5页，
        // 少于等于于5页的时候，前后都不设置点，直接遍历存入分页栏数组即可
        // 多于5页的时候，分为三种情况，一种是当前页面少于等于3页的时候，前面不设置点；
                                // 当前页多于总页数-2的时候，从总页数-4开始，后面不设置点；
                                // 当前页大于3小于总页数-2的时候，显示当前页的前两页和当前页的后五页
        if ($scope.resultMap.totalPages > 5) {       //如果总页数大于5页,显示部分页码
            if ($scope.searchMap.pageNo <= 3) {     //如果当前页页码小于等于3
                lastPage = 5; //前5页
                $scope.firstDot = false;    //前面没点
            } else if ($scope.searchMap.pageNo >= lastPage - 2) {   //如果当前页大于等于最大页码-2
                firstPage = $scope.resultMap.totalPages - 4;		 //后5页
                $scope.lastDot = false;//后边没点
            } else { //显示当前页为中心的5页
                firstPage = $scope.searchMap.pageNo - 2;
                lastPage = $scope.searchMap.pageNo + 2;
            }
        } else {
            $scope.firstDot = false;//前面无点
            $scope.lastDot = false;//后边无点

        }
        //循环产生页码标签,从开始页码到截止页码，如果总页数小于5则全显示
        for (var i = firstPage; i <= lastPage; i++) {
            $scope.pageLabel.push(i);
        }
    }
```

​	写好后在js的查询方法中调用，再到HTML页面对应的页面遍历分页栏数组。

此外，分页还要注意就是第一页和最后一页的上一页和下一页是不能点的，可以通过两个方法来判断是否为第一页或者最后一页，然后在点击上一页和下一页的标签样式中调用，如果是第一页或者最后一页，则对应的标签样式是无效的。

```js
// controller.js
//判断当前页是否为第一页
$scope.isTopPage = function () {
    if ($scope.searchMap.pageNo == 1) {
        return true;
    } else {
        return false;
    }
}

//判断当前页是否为最后一页
$scope.isEndPage = function () {
    if ($scope.searchMap.pageNo == $scope.resultMap.totalPages) {
        return true;
    } else {
        return false;
    }
}
```

```html
<!--'disabled'表示是白色,即可以点击的，isTopPage判断是否为第一页，如果是的话点击的样式不可用-->
<li class="prev {{isTopPage()?'disabled':''}}">
    <a href="#" ng-click="queryByPage(searchMap.pageNo-1)">«</a>
</li>
<li class="next {{isEndPage()?'disabled':''}}">
    <a href="#" ng-click="queryByPage(searchMap.pageNo+1)">»</a>
</li>
```

## 2.FreeMarker生成文件，生产数据

使用步骤：

第一步：创建一个 Configuration 对象，直接 new 一个对象。构造方法的参数就是 freemarker的版本号。

第二步：设置模板文件所在的路径。

第三步：设置模板文件使用的字符集。一般就是 utf-8.

第四步：加载一个模板，创建一个模板对象。

第五步：创建一个模板使用的数据集，可以是 pojo 也可以是 map。一般是 Map。

第六步：创建一个 Writer 对象，一般创建一 FileWriter 对象，指定生成的文件名。

第七步：调用模板对象的 process 方法输出文件。

第八步：关闭流

### 模板文件中四种元素

  1、文本，直接输出的部分(body)
   2、注释，即<#--...-->格式不会输出
   3、插值（Interpolation）：==即${..}部分,将使用数据模型中的部分替代输出==，相当于调用数据
   4、FTL指令：FreeMarker指令，和HTML标记类似，名字前加#予以区分，不会输出。

模板文件：

```html
<html>
<head>
	<meta charset="utf-8">
	<title>Freemarker入门小DEMO </title>
</head>
<body>
<#--我只是一个注释，我不会有任何输出  -->
${name},你好。${message}
</body>
</html>
```

创建Test类 main方法如下：

```Java
	     //1.创建配置类(对象)
		Configuration configuration=new Configuration(Configuration.getVersion());
		//2.设置上面创建的模板所在的目录 
		configuration.setDirectoryForTemplateLoading(new File("D:/pinyougou_work/freemarkerDemo/src/main/resources/"));
		//3.设置字符集
		configuration.setDefaultEncoding("utf-8");
		//4.加载模板
		Template template = configuration.getTemplate("test.ftl");
		//5.创建数据模型(可以是pojo对象，也可以是map，map的key对应ftl文件中的属性名)
		Map map=new HashMap();
		map.put("name", "张三 ");
		map.put("message", "欢迎来到神奇的品优购世界！");
		//6.创建Writer输出流对象，可以指定
		Writer out =new FileWriter(new File("d:\\test.html"));
		//7.通过模板对象输出
		template.process(map, out);
		//8.关闭Writer对象
		out.close();

```

# 二、后端